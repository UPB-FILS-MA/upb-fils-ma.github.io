"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1224],{92464:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>o,frontMatter:()=>r,metadata:()=>l,toc:()=>h});var t=n(17624),i=n(4552);const r={sidebar_position:3,description:"Bare metal MMIO, PAC access and embassy-rs",slug:"/lab/02"},a="02 - Memory Mapped IO & GPIO",l={id:"lab/02/02",title:"02 - Memory Mapped IO & GPIO",description:"Bare metal MMIO, PAC access and embassy-rs",source:"@site/docs/lab/02/02.md",sourceDirName:"lab/02",slug:"/lab/02",permalink:"/docs/lab/02",draft:!1,unlisted:!1,editUrl:"https://github.com/UPB-FILS-MA/upb-fils-ma.github.io/edit/main/docs/lab/02/02.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"Bare metal MMIO, PAC access and embassy-rs",slug:"/lab/02"},sidebar:"tutorialSidebar",previous:{title:"01 - Hardware Introduction",permalink:"/docs/lab/01"},next:{title:"03 - Exceptions & Interrupts",permalink:"/docs/lab/03"}},d={},h=[{value:"Resources",id:"resources",level:2},{value:"What is GPIO?",id:"what-is-gpio",level:2},{value:"Configuring GPIO Pins",id:"configuring-gpio-pins",level:2},{value:"Hardware access",id:"hardware-access",level:2},{value:"Embedded HAL Implementation",id:"embedded-hal-implementation",level:2},{value:"Embassy-rs framework",id:"embassy-rs-framework",level:3},{value:"Entry",id:"entry",level:3},{value:"Configure GPIO Output",id:"configure-gpio-output",level:3},{value:"Configure GPIO Input",id:"configure-gpio-input",level:3},{value:"Waiting",id:"waiting",level:3},{value:"Platform Access Crate (PAC)",id:"platform-access-crate-pac",level:2},{value:"no-std",id:"no-std",level:3},{value:"Bootloader",id:"bootloader",level:3},{value:"Entry",id:"entry-1",level:3},{value:"Configuring the SIO",id:"configuring-the-sio",level:3},{value:"Configuring the IO Bank0",id:"configuring-the-io-bank0",level:3},{value:"Enable the IO Bank0",id:"enable-the-io-bank0",level:4},{value:"Configure the GPIO",id:"configure-the-gpio",level:4},{value:"Configuring the Pad",id:"configuring-the-pad",level:3},{value:"Wait for an amount of time",id:"wait-for-an-amount-of-time",level:3},{value:"Bare metal",id:"bare-metal",level:2},{value:"Configuring the SIO",id:"configuring-the-sio-1",level:3},{value:"Enable the IO Bank",id:"enable-the-io-bank",level:4},{value:"Configure the GPIO",id:"configure-the-gpio-1",level:4},{value:"Build and flash",id:"build-and-flash",level:2},{value:"Build",id:"build",level:3},{value:"Flash",id:"flash",level:3},{value:"Serial console",id:"serial-console",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Link error - reset vector is missing",id:"link-error---reset-vector-is-missing",level:4},{value:"Flash succeeds, the application does not start",id:"flash-succeeds-the-application-does-not-start",level:4},{value:"Exercises",id:"exercises",level:2},{value:"Advanced topics",id:"advanced-topics",level:2},{value:"Debouncing techniques for stable input reading.",id:"debouncing-techniques-for-stable-input-reading",level:3}];function c(e){const s={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",math:"math",mdxAdmonitionTitle:"mdxAdmonitionTitle",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"02---memory-mapped-io--gpio",children:"02 - Memory Mapped IO & GPIO"}),"\n",(0,t.jsxs)(s.p,{children:["The purpose of this lab is to understand how to start developing in ",(0,t.jsx)(s.a,{href:"https://www.rust-lang.org/",children:"Rust"})," for the\nRP2040 MCU. The lab presents three examples:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"bare metal"})," development - writing directly to registers, actually writing a driver"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"platform access crate"})," (PAC) - using an automatically generated crate from the MCUs SVD file, actually writing a driver, but with some kind of automation"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"embassy-rs"})," - using the Rust standard ",(0,t.jsx)(s.a,{href:"https://docs.rs/embedded-hal/latest/embedded_hal/",children:(0,t.jsx)(s.code,{children:"embedded-hal"})})," implemented by the ",(0,t.jsx)(s.a,{href:"https://embassy.dev/",children:"Embassy-rs"})," framework."]}),"\n"]}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsx)(s.p,{children:"The example of this lab is to blink an LED at a certain time interval."})}),"\n",(0,t.jsx)(s.h2,{id:"resources",children:"Resources"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Raspberry Pi Ltd"}),", ",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.a,{href:"https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf",children:"RP2040 Datasheet"})})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Raspberry Pi Ltd"}),", ",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.a,{href:"https://datasheets.raspberrypi.com/pico/pico-datasheet.pdf",children:"Raspberry Pi Pico Datasheet"})})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Raspberry Pi Ltd"}),", ",(0,t.jsx)(s.em,{children:(0,t.jsx)(s.a,{href:"https://datasheets.raspberrypi.com/picow/pico-w-datasheet.pdf",children:"Raspberry Pi Pico W Datasheet"})})]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"what-is-gpio",children:"What is GPIO?"}),"\n",(0,t.jsx)(s.p,{children:"General-Purpose Input/Output, or GPIO, is an essential part of embedded systems that serves as a vital conduit between microcontrollers and microprocessors and the outside world. A microcontroller or microprocessor's group of pins that can each be set to operate as an input or an output is referred to as GPIO. The purpose of these pins is to interface external components, including actuators, displays, sensors, and other devices, so that the embedded system may communicate with its surroundings. Standardised communication protocols like SPI, I2C, PCM, PWM, and serial communication may be directly supported by some GPIO pins. There are two varieties of GPIO pins: digital and analog."}),"\n",(0,t.jsx)(s.h2,{id:"configuring-gpio-pins",children:"Configuring GPIO Pins"}),"\n",(0,t.jsx)(s.p,{children:"GPIO pins can be used as outputs (LEDs, motors, buzzers) or as inputs (buttons, sensors)."}),"\n",(0,t.jsx)(s.p,{children:"The R02040 has three peripherals that control the GPIO pins:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.em,{children:"Pads"})," - control the actual physical pin or pad that the processor has outside. This control the electrical parameters, like maximum current or pull up and pull down resistors"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.em,{children:"IO Bank0"})," - connects and multiplexes the peripheral's pins to the output pads. Several peripherals use the same output pad to communicate with the exterior. For example, in the image below, ",(0,t.jsx)(s.code,{children:"GPIO0"})," can be used either for:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"SIO"})," - the ",(0,t.jsx)(s.code,{children:"GPIO"})," function"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"SPI_RX"})," - the receive pin for the ",(0,t.jsx)(s.code,{children:"SPI"})," peripheral"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"I2C0_SDA"})," - the data pin for the ",(0,t.jsx)(s.code,{children:"I2C0"})," peripheral"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"UART0_TX"})," - the transmit pin for the ",(0,t.jsx)(s.code,{children:"UART0"})," (serial port 0) peripheral"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.em,{children:"SIO"})," - that controls the interior MCU's pins. This is the peripheral that developers use to read and write the value of the pins."]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Pico Pinout",src:n(2388).c+"",width:"842",height:"595"})}),"\n",(0,t.jsxs)(s.p,{children:["Every pin of the MCU can perform multiple functions. Several peripherals need to use input and output pins.\nIt is the role of the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," to multiplex and connect the peripherals to the pins."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"IO Bank0",src:n(89836).c+"",width:"1574",height:"1114"})})}),"\n",(0,t.jsx)(s.h2,{id:"hardware-access",children:"Hardware access"}),"\n",(0,t.jsx)(s.p,{children:"There are 3 different ways in which the hardware the Raspberry Pi Pico can be used:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Embassy-rs framework, with the Embedded HAL implementation"}),"\n",(0,t.jsx)(s.li,{children:"Platform Access Crate (PAC)"}),"\n",(0,t.jsx)(s.li,{children:"Bare metal"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"embedded-hal-implementation",children:"Embedded HAL Implementation"}),"\n",(0,t.jsx)(s.p,{children:"The bare metal and PAC require a lot of time and effort to develop applications."}),"\n",(0,t.jsxs)(s.p,{children:["The Rust ",(0,t.jsx)(s.a,{href:"https://www.rust-lang.org/governance/wgs/embedded",children:"Embedded devices Working Group"})," has designed\na  set of standard traits (interfaces) for interacting with an MCU. This is called the ",(0,t.jsx)(s.strong,{children:"Embedded Hardware Abstraction Layer"}),", or shortly Embedded HAL. The main purpose is to define a common hardware interface that\nframeworks, libraries and operating systems can build upon. Regardless of what MCUs the device is using, the upper level software should be as portable as possible."]}),"\n",(0,t.jsx)(s.p,{children:"There are several crates and frameworks that implement the Embedded HAL traits for the RP2040 MCU."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://docs.rs/rp2040-hal/latest/rp2040_hal/",children:"rp2040_hal"})," crate, implements just the embedded HAL traits, it is ",(0,t.jsx)(s.em,{children:"the bare minimum"})," for developing RP2040 applications"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-rp/git/rp2040/index.html",children:"embassy-rp"})," crate implements the Embedded HAL for RP2040 that is used with the ",(0,t.jsx)(s.a,{href:"https://embassy.dev/",children:"embassy-rs"})," framework"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"embassy-rs-framework",children:"Embassy-rs framework"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://embassy.dev/",children:"Embassy-rs"})," is a full fledged embedded framework for Rust embedded development.\nBesides the implementation of the embedded HAL for different MCUs (RP2040 included), embassy-rs provides\nseveral functions like timers, BLE and network communication."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Rust EMbedded Stack",src:n(14508).c+"",width:"451",height:"291"})})}),"\n",(0,t.jsx)(s.p,{children:"The crates used by Embassy-rs and their mapping are shown in the table bellow."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Crate"}),(0,t.jsx)(s.th,{children:"Position"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-executor/git/cortex-m/index.html",children:(0,t.jsx)(s.code,{children:"embassy-executor"})})}),(0,t.jsx)(s.td,{children:"Framework"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"https://docs.rs/smoltcp/latest/smoltcp/",children:(0,t.jsx)(s.code,{children:"smoltcp"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.rs/defmt/latest/defmt/",children:(0,t.jsx)(s.code,{children:"defmt"})})]}),(0,t.jsx)(s.td,{children:"Libraries"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-net/git/default/index.html",children:(0,t.jsx)(s.code,{children:"embassy-net"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-time/git/default/index.html",children:(0,t.jsx)(s.code,{children:"embassy-time"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-usb/git/default/index.html",children:(0,t.jsx)(s.code,{children:"embassy-usb"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-usb-logger/git/default/index.html",children:(0,t.jsx)(s.code,{children:"embassy-usb-logger"})})]}),(0,t.jsx)(s.td,{children:"Framework Driver"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-usb-driver/git/default/index.html",children:(0,t.jsx)(s.code,{children:"embassy-usb-driver"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-time-driver/git/default/index.html",children:(0,t.jsx)(s.code,{children:"embassy-time-driver"})})]}),(0,t.jsx)(s.td,{children:"Embassy HAL (API)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/cyw43/git/default/index.html",children:(0,t.jsx)(s.code,{children:"cyw43"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/cyw43-pio/git/default/index.html",children:(0,t.jsx)(s.code,{children:"cyw43-pio"})})]}),(0,t.jsx)(s.td,{children:"Driver (WiFi)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"https://docs.rs/embedded-hal/latest/embedded_hal/",children:(0,t.jsx)(s.code,{children:"embedded-hal"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.rs/embedded-hal-async/latest/embedded_hal_async/",children:(0,t.jsx)(s.code,{children:"embedded-hal-async"})})]}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Rust Embedded HAL (Standard)"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/embassy-rp/git/rp2040/index.html",children:(0,t.jsx)(s.code,{children:"embassy_rp"})})}),(0,t.jsx)(s.td,{children:"HAL Implementation"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"https://docs.rs/cortex-m/latest/cortex_m/",children:(0,t.jsx)(s.code,{children:"cortex-m"})}),", ",(0,t.jsx)(s.a,{href:"https://docs.rs/cortex-m-rt/latest/cortex_m_rt/",children:(0,t.jsx)(s.code,{children:"cortex-m-rt"})})]}),(0,t.jsx)(s.td,{children:"\u03bc-architecture crates"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.a,{href:"https://docs.embassy.dev/rp-pac/git/default/index.html",children:(0,t.jsx)(s.code,{children:"rp_pac"})})}),(0,t.jsx)(s.td,{children:"Platform Access Crate"})]})]})]}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsxs)(s.p,{children:["The name ",(0,t.jsx)(s.em,{children:"Embassy-rs"})," is derived form ",(0,t.jsx)(s.strong,{children:"Emb"}),"edded ",(0,t.jsx)(s.strong,{children:"Asy"}),"nchronous Rust."]})}),"\n",(0,t.jsx)(s.h3,{id:"entry",children:"Entry"}),"\n",(0,t.jsxs)(s.p,{children:["Embassy-rs is a framework built on top of ",(0,t.jsx)(s.code,{children:"cortex-m-rt"})," and provides its own method of defining\nthe entrypoint and bootloader."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"use embassy_executor::Spawner;\n\n#[embassy_executor::main]\nasync fn main(_spawner: Spawner) {\n    let peripherals = embassy_rp::init(Default::default());\n}\n"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"embassy_rp::init"})," function takes care of the peripheral initialization so that developers can jump\nright in and use them."]}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["Embassy-rs is designed to work in an asynchronous way and this is why the ",(0,t.jsx)(s.code,{children:"main"})," function is defined as ",(0,t.jsx)(s.code,{children:"async"}),". For the time being, just take it as a must and ignore it."]})}),"\n",(0,t.jsx)(s.h3,{id:"configure-gpio-output",children:"Configure GPIO Output"}),"\n",(0,t.jsxs)(s.p,{children:["Embassy-rs provides one single function that returns the GPIO ",(0,t.jsx)(s.code,{children:"Output"})," pin and hides the configuration\ndetails from developers."]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"pin"})," variable implements the embadded HAL ",(0,t.jsx)(s.a,{href:"https://docs.rs/embedded-hal/latest/embedded_hal/digital/trait.OutputPin.html",children:(0,t.jsx)(s.code,{children:"OutputPin"})})," trait."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"use gpio::{Level, Output};\n\n// initialize PIN_n (replace n with a number) and set its\n// default value to LOW (0)\nlet mut pin = Output::new(peripherals.PIN_n, Level::Low);\n\n// set the pin value to HIGH (1)\npin.set_high();\n\n// set the pin value to LOW (0)\npin.set_low();\n"})}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsxs)(s.p,{children:["While the device initialization is specific to every hardware device (the example uses the\n",(0,t.jsx)(s.code,{children:"embassy_rp"})," crate that is for RP2040), the pin initialization and usage is portable. It\nuses the same code, regardless of the MCU used."]})}),"\n",(0,t.jsx)(s.h3,{id:"configure-gpio-input",children:"Configure GPIO Input"}),"\n",(0,t.jsx)(s.p,{children:"Using a pin as input is very similar to using it as output."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"use gpio::{Input, Pull};\n\nlet pin = Input::new(peripherals.PIN_n, Pull::Up);\n\nif pin.is_high() {\n    // Do something if the pin value is HIGH (1)\n} else {\n    // Do something if the pin value if LOW (0)\n}\n"})}),"\n",(0,t.jsxs)(s.admonition,{type:"warning",children:[(0,t.jsx)(s.mdxAdmonitionTitle,{}),(0,t.jsxs)(s.p,{children:["For a correct use of the buttons, use pull-up, pull-down resistors depending on the mode of operation of the button. Check ",(0,t.jsx)(s.a,{href:"https://embedded-rust-101.wyliodrin.com/docs/lab/01#buttons",children:"01 - Hardware Introduction"})]})]}),"\n",(0,t.jsx)(s.h3,{id:"waiting",children:"Waiting"}),"\n",(0,t.jsxs)(s.p,{children:["Embassy-rs provides support for suspending the execution of the software for an amount of time. It uses\nthe ",(0,t.jsx)(s.a,{href:"https://docs.rs/embassy-time/0.3.0/embassy_time/struct.Timer.html",children:(0,t.jsx)(s.code,{children:"Timer"})})," structure from the\n",(0,t.jsx)(s.a,{href:"https://docs.rs/embassy-time/latest/embassy_time/",children:(0,t.jsx)(s.code,{children:"embassy_time"})})," crate."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"// suspend the execution for a period of time\nuse embassy_time::Timer;\n\nTimer::after_secs(1).await;\n"})}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsx)(s.p,{children:"If the MCU provides timers, the Embassy framework will use them to suspend the software. This is very efficient."})}),"\n",(0,t.jsx)(s.h2,{id:"platform-access-crate-pac",children:"Platform Access Crate (PAC)"}),"\n",(0,t.jsxs)(s.p,{children:["A mid level way of developing in Rust for MCUs are the ",(0,t.jsx)(s.em,{children:"platform access crates"}),"\n(PAC). These crates are automatically generated from the ",(0,t.jsx)(s.em,{children:"System View Description"})," (SVD) files."]}),"\n",(0,t.jsxs)(s.p,{children:["Using ",(0,t.jsx)(s.a,{href:"https://docs.rs/svd2rust/latest/svd2rust/",children:"rust2svd"}),", developers can automatically generate\na crate that provides access functions to the MCUs registers. This provides a significant improvement,\nas developers do not have to write manually the register addresses."]}),"\n",(0,t.jsxs)(s.p,{children:["One of the PAC crates for the RP2040 MCU is ",(0,t.jsx)(s.a,{href:"https://docs.rs/rp2040-pac/latest/rp2040_pac/",children:"rp2040-pac"}),"."]}),"\n",(0,t.jsxs)(s.admonition,{type:"note",children:[(0,t.jsxs)(s.p,{children:["The PAC crate does not provide any means of initializing the MCU, so the entry point is still\ndefined by the ",(0,t.jsx)(s.code,{children:"cortex-m-rt"})," crate, just as it is for bare metal. Bare metal will be discussed later in the lab."]}),(0,t.jsxs)(s.p,{children:["Similarly, the PAC crate does not provide any ",(0,t.jsx)(s.code,{children:"sleep"})," function."]}),(0,t.jsx)(s.p,{children:"This section presents only the differences between bare metal and PAC. The PAC mode of writing\nembedded software is very similar to bare metal, just that register access is made easier."})]}),"\n",(0,t.jsxs)(s.p,{children:["The RP2040 (ARM Cortex-M0+) MCU uses ",(0,t.jsx)(s.em,{children:"Memory Mapped Input Output"})," (MMIO). This means that the peripheral's registers\nare mapped into the address space (in normal words, in the memory). Reading and writing data from and to these registers\nis done by memory reads and writes."]}),"\n",(0,t.jsx)(s.p,{children:"Blinking an LED in PAC or bare metal programming means following these steps:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Ask the rust compiler not to use the ",(0,t.jsx)(s.code,{children:"std"})," library, as it depends on the operating system"]}),"\n",(0,t.jsxs)(s.li,{children:["Write a ",(0,t.jsx)(s.code,{children:"main"})," function and instruct the MCU to call it at startup (reset)"]}),"\n",(0,t.jsx)(s.li,{children:"Configure the Single Cycle IO (SIO) peripheral to set a pin as output"}),"\n",(0,t.jsxs)(s.li,{children:["Enable the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," peripheral of the RP2040"]}),"\n",(0,t.jsxs)(s.li,{children:["Configure the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," peripheral so that it sets a certain pin as output"]}),"\n",(0,t.jsxs)(s.li,{children:["Toggle the pin's value through the ",(0,t.jsx)(s.em,{children:"SIO"}),"'s registers"]}),"\n",(0,t.jsx)(s.li,{children:"Wait for an amount of time"}),"\n",(0,t.jsx)(s.li,{children:"Loop through steps 6 and 7"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"no-std",children:"no-std"}),"\n",(0,t.jsxs)(s.p,{children:["As the code written runs on an MCU without any framework or operating system,\nthe Rust compiler cannot rely on the ",(0,t.jsx)(s.code,{children:"std"})," library. The two macros directives\nask the compiler not to link the ",(0,t.jsx)(s.code,{children:"std"})," library and not to expect ",(0,t.jsx)(s.code,{children:"main"}),"\nfunction."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"#![no_main]\n#![no_std]\n"})}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsx)(s.p,{children:"The bare metal code has to start with these two directives."})}),"\n",(0,t.jsx)(s.h3,{id:"bootloader",children:"Bootloader"}),"\n",(0,t.jsx)(s.p,{children:"The RP2040 has a piece of software written in an internal ROM memory that is loaded\nwhen the MCU boots. This looks at the first 256 bytes of the Flash memory\nto understand how it needs to start the MCU."}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsx)(s.p,{children:"While the ROM bootloader is rather small, its functionality is very similar to the PC's BIOS\nboot sequence."})}),"\n",(0,t.jsxs)(s.p,{children:["The RP2040's datasheet explains the boot process. This is not very straight forward, and writing this\ninformation requires a digital signature. The ",(0,t.jsx)(s.code,{children:"rp2040-boot"})," crate provides the bootloader information\nfor booting with the ",(0,t.jsx)(s.code,{children:"cortex-m-rt"})," crate."]}),"\n",(0,t.jsx)(s.p,{children:"Adding the following code to the Rust includes the bootloader."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:'#[link_section = ".boot_loader"]\n#[used]\npub static BOOT_LOADER: [u8; 256] = rp2040_boot2::BOOT_LOADER_W25Q080;\n'})}),"\n",(0,t.jsx)(s.h3,{id:"entry-1",children:"Entry"}),"\n",(0,t.jsxs)(s.p,{children:["For this lab, we will use the ",(0,t.jsx)(s.code,{children:"cortex-m-rt"})," crate. As the starting code for an MCU is usually processor\nand vendor dependent, this crate allows developers to get started a little faster. It implements the bare minimum\ninitialization code and provides a macro called ",(0,t.jsx)(s.code,{children:"entry"})," that developers can use to select the startup (main)\nfunction."]}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"entry"})," macro is used by Embassy through the ",(0,t.jsx)(s.code,{children:"embassy_executor::main"})," macro that sets the ",(0,t.jsx)(s.code,{children:"main"})," function as the startup point and defines the correct bootloader."]})}),"\n",(0,t.jsxs)(s.p,{children:["When an error occurs, Rust calls the ",(0,t.jsx)(s.code,{children:"panic"})," function. When using the ",(0,t.jsx)(s.code,{children:"std"})," library, the ",(0,t.jsx)(s.code,{children:"panic"})," function is\nalready defined. It prints the error and usually unwinds the stack. When using ",(0,t.jsx)(s.code,{children:"core"}),", it is the developer's\njob to define a ",(0,t.jsx)(s.code,{children:"panic"})," function. In the case of bare metal development, the simplest ",(0,t.jsx)(s.code,{children:"panic"})," function is\none that loops indefinitely, preventing the MCU form executing code."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"use core::panic::PanicInfo;\n\nuse cortex_m_rt::entry;\n\n// the `entry` macro sets up this function\n// as the function that the MCU calls at\n// startup\n#[entry]\nfn main() -> ! {\n    // the `main` function is not allows to return\n    loop { }\n}\n\n// rust uses panics when an error occurs\n// as this is bare metal, we have to define\n// the panic function that rust calls\n#[panic_handler]\nfn panic(_info: &PanicInfo) -> ! {\n    // if an error occurs, we simply loop around\n    // to prevent the MCU from executing \n    // anything\n    loop {}\n}\n"})}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsxs)(s.p,{children:["In PAC or bare metal mode, the MCU does not run any framework or operating system, it just runs the developers bare metal code. This is why ",(0,t.jsx)(s.code,{children:"main"})," function is not allowed to return, it loops forever. There is no system to which the function\ncould return control."]})}),"\n",(0,t.jsxs)(s.p,{children:["One of the first lines of the ",(0,t.jsx)(s.code,{children:"main"})," function is getting a reference to all the\nperipherals."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"use rp2040_pac::Peripherals;\n\n#[entry]\nfn main() -> ! {\n    // get a reference to all the peripherals\n    let peripherals = Peripherals::take().unwrap();\n\n    loop { }\n}\n"})}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsxs)(s.p,{children:["In Embassy, the ",(0,t.jsx)(s.code,{children:"main"})," function does not have to loop indefinitely, it is allowed to return, as it runs within the embassy-rs framework."]})}),"\n",(0,t.jsx)(s.h3,{id:"configuring-the-sio",children:"Configuring the SIO"}),"\n",(0,t.jsxs)(s.p,{children:["In bare metal and PAC modes, developers have to manually initialize the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," and ",(0,t.jsx)(s.em,{children:"SIO"})," peripherals."]}),"\n",(0,t.jsx)(s.p,{children:"The GPIO pins are configured using the MCU's SIO registers. Each pin is configured by setting or clearing the corresponding\nbit of several registers. Below is a table with the memory addresses of the SIO registers."}),"\n",(0,t.jsxs)(s.p,{children:["The PAC crate provides the ",(0,t.jsx)(s.code,{children:"SIO"})," peripheral, which in turn provides a function for\neach one of its registers. It fully hides the actual address of the registers."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"SIO Registers",src:n(13612).c+"",width:"1564",height:"826"})})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"let sio = peripherals.SIO;\n\n// set the `pin` pin as output\nsio.gpio_oe_set().write(|w| unsafe { w.bits(1 << pin) });\n\n// set the `pin` to value `0`\nsio.gpio_out_clr().write(|w| unsafe { w.bits(1 << pin) })\n\n// set the `pin` to value `1`\nsio.gpio_out_set().write(|w| unsafe { w.bits(1 << pin) })\n"})}),"\n",(0,t.jsx)(s.h3,{id:"configuring-the-io-bank0",children:"Configuring the IO Bank0"}),"\n",(0,t.jsxs)(s.p,{children:["GPIO pins can be configured for several functionalities, they can be used as GPIO pins or can also be used by certain peripherals, usually those that implement communication protocols. The RP2040's ",(0,t.jsx)(s.em,{children:"IO Bank0"})," peripherals performs this multiplexing."]}),"\n",(0,t.jsx)(s.p,{children:"The following table provides all the functions that each pin can have."}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Pin Functions",src:n(45840).c+"",width:"1348",height:"1424"})})}),"\n",(0,t.jsx)(s.h4,{id:"enable-the-io-bank0",children:"Enable the IO Bank0"}),"\n",(0,t.jsxs)(s.p,{children:["When the RP2040 starts, the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," peripheral is disabled. To enable it, developers have to\nuse the ",(0,t.jsx)(s.em,{children:"Reset"}),"'s peripheral ",(0,t.jsx)(s.code,{children:"RESET"}),"  register."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Reset Registers",src:n(44912).c+"",width:"1518",height:"342"})})}),"\n",(0,t.jsxs)(s.p,{children:["The fields of the ",(0,t.jsx)(s.code,{children:"RESET"})," register. To enable ",(0,t.jsx)(s.em,{children:"IO Bank0"}),", developers have to write\na ",(0,t.jsx)(s.code,{children:"0"})," in the ",(0,t.jsx)(s.code,{children:"IO_BANK0"})," fields. By default, this field has the value ",(0,t.jsx)(s.code,{children:"1"}),", which means that\n`",(0,t.jsx)(s.em,{children:"IO Bank0"})," is disabled."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Reset Register",src:n(61436).c+"",width:"1514",height:"1276"})})}),"\n",(0,t.jsxs)(s.p,{children:["To verify that the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," peripheral has been enabled, developers have to check the field\n",(0,t.jsx)(s.code,{children:"IO_BANK0"})," of the ",(0,t.jsx)(s.code,{children:"RESET_DONE"})," register shown in the table bellow."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Reset Done Register",src:n(65772).c+"",width:"1512",height:"748"})})}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsx)(s.p,{children:"Developers might choose not to wait until the peripheral is enabled, but any writes to the peripheral's\nregisters will most probably be ignored."})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"let reset = peripherals.RESETS;\n\nreset\n    .reset()\n    .modify(|r, w| unsafe { w.bits(r.bits() & !(1 << 5)) });\nwhile reset.reset_done().read().bits() & (1 << 5) == 0 {}\n"})}),"\n",(0,t.jsx)(s.h4,{id:"configure-the-gpio",children:"Configure the GPIO"}),"\n",(0,t.jsxs)(s.p,{children:["To connect the ",(0,t.jsx)(s.em,{children:"SIO"})," peripheral to the output pins, developers have to modify the ",(0,t.jsx)(s.code,{children:"GPIOx_CTRL"})," register."]}),"\n",(0,t.jsxs)(s.p,{children:["The following table shows the fields of the ",(0,t.jsx)(s.code,{children:"GPIOx_CTRL"})," register. The fields that is of interest is ",(0,t.jsx)(s.code,{children:"FUNCSEL"}),".\nDepending on the value written there, the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," will select a function or another. For this example,\nwe have to write value ",(0,t.jsx)(s.code,{children:"5"}),"."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"MCU Pins",src:n(85400).c+"",width:"1444",height:"1416"})})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"let io_bank0 = peripherals.IO_BANK0;\n\n// write the value 5 to the FUNCSEL field\n// Note: This actually writes the value 5 in FUNCSEL\n//       and 0s in all the other field. While this\n//       is fine for this example, usually a\n//       read, modify, write sequence should be used\nio_bank0\n    .gpio(pin)\n    .gpio_ctrl()\n    .write(|w| unsafe { w.bits(5) });\n\n// the correct way of doing this\nio_bank0\n    .gpio(pin)\n    .gpio_ctrl()\n    // the PAC crate provides fucntions for all the \n    // register's fields\n    .modify(|_, w| unsafe { w.funcsel().bits(5) });\n"})}),"\n",(0,t.jsx)(s.h3,{id:"configuring-the-pad",children:"Configuring the Pad"}),"\n",(0,t.jsx)(s.p,{children:"The Pad peripheral is responsible for the electrical setup of the pins. It can configure the\nthe maximum output current, input pull up or pull down resistor."}),"\n",(0,t.jsxs)(s.p,{children:["The following table shows the ",(0,t.jsx)(s.em,{children:"Pads"})," peripheral registers. Each GPIO pin has a corresponding register."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Pad Registers",src:n(49944).c+"",width:"1648",height:"656"})})}),"\n",(0,t.jsxs)(s.p,{children:["The following tables describe the ",(0,t.jsx)(s.code,{children:"GPIOx"})," register. This register allows the configuration of several\nelectrical parameters."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Pad Pad Control 2",src:n(48180).c+"",width:"1652",height:"352"})})}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Pad Pad Control 1",src:n(62888).c+"",width:"1646",height:"632"})})}),"\n",(0,t.jsx)(s.p,{children:"Looking at the default values, when the MCU starts, pins are configured:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Output Enabled"}),(0,t.jsx)(s.td,{children:"Yes"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Input Enabled"}),(0,t.jsx)(s.td,{children:"Yes"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Maximum Output Current"}),(0,t.jsx)(s.td,{children:"4mA"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Pull Input Resistor"}),(0,t.jsx)(s.td,{children:"Pull Down"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Schmidt Trigger"}),(0,t.jsx)(s.td,{children:"Yes"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Slew Rate"}),(0,t.jsx)(s.td,{children:"Slow"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:"For this lab, the default values are fine, this peripheral can be considered as being properly setup."}),"\n",(0,t.jsx)(s.h3,{id:"wait-for-an-amount-of-time",children:"Wait for an amount of time"}),"\n",(0,t.jsxs)(s.p,{children:["When using an operating system, developers usually have a function called ",(0,t.jsx)(s.code,{children:"sleep"})," which asks the operating system\nto suspend the process for a certain amount of time. In bare metal environment, with no framework or operating system,\nthis is not available. The MCU timers can be used for this, but the simplest (and most inefficient) of waiting is to\nloop around while doing nothing. The Arm Cortex-M processors offer the ",(0,t.jsx)(s.code,{children:"nop"})," instruction. This asks the processor\nto do nothing."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:'// loops around 50000 times asking the processor\n// to execute the `nop` instruction that does\n// nothing\nfor _ in 0..50000 {\n    // without this `asm` here, the compiler would optimize out the loop\n    asm!("nop");\n}\n'})}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:'asm("nop")'})," is necessary, as otherwise the compiler optimizes out the empty loop."]})}),"\n",(0,t.jsx)(s.p,{children:"The question is how fast does this execute. The RP2040 starts by default using an internal 12MHz clock."}),"\n",(0,t.jsx)(s.span,{className:"katex-display",children:(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"t"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mi,{children:"o"}),(0,t.jsx)(s.mi,{children:"p"})]})]}),(0,t.jsx)(s.mo,{children:"="}),(0,t.jsxs)(s.mfrac,{children:[(0,t.jsx)(s.mn,{children:"1"}),(0,t.jsx)(s.mn,{children:"12.000.000"})]}),(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mo,{children:"="}),(0,t.jsx)(s.mn,{children:"0.83"}),(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mi,{children:"s"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"t_{nop} = \\frac{1}{12.000.000}s = 0.83ns"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.9012em",verticalAlign:"-0.2861em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"o"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"p"})]})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.2861em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"="}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"2.0074em",verticalAlign:"-0.686em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,t.jsx)(s.span,{className:"mfrac",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,t.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"mord",children:(0,t.jsx)(s.span,{className:"mord",children:"12.000.000"})})]}),(0,t.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,t.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"mord",children:(0,t.jsx)(s.span,{className:"mord",children:"1"})})]})]}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,t.jsx)(s.span,{})})})]})}),(0,t.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"="}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,t.jsx)(s.span,{className:"mord",children:"0.83"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"})]})]})]})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"loop"})," itself and the range (",(0,t.jsx)(s.code,{children:"0..50000"}),") calculation take another 4 - 5 MCU cycles. The actual wait time\nof the example is:"]}),"\n",(0,t.jsx)(s.span,{className:"katex-display",children:(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"t"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"w"}),(0,t.jsx)(s.mi,{children:"a"}),(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mi,{children:"t"})]})]}),(0,t.jsx)(s.mo,{children:"="}),(0,t.jsx)(s.mn,{children:"5"}),(0,t.jsx)(s.mo,{children:"\u2217"}),(0,t.jsx)(s.mn,{children:"50000"}),(0,t.jsx)(s.mo,{children:"\u2217"}),(0,t.jsxs)(s.mfrac,{children:[(0,t.jsx)(s.mn,{children:"1"}),(0,t.jsx)(s.mn,{children:"12.000.000"})]}),(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mo,{children:"="}),(0,t.jsx)(s.mn,{children:"20.83"}),(0,t.jsx)(s.mi,{children:"\u03bc"}),(0,t.jsx)(s.mi,{children:"s"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"t_{wait} = 5 * 50000 * \\frac{1}{12.000.000}s = 20.83\\mu s"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7651em",verticalAlign:"-0.15em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsxs)(s.span,{className:"mord mtight",children:[(0,t.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"ai"}),(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"t"})]})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"="}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,t.jsx)(s.span,{className:"mord",children:"5"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(s.span,{className:"mbin",children:"\u2217"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,t.jsx)(s.span,{className:"mord",children:"50000"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(s.span,{className:"mbin",children:"\u2217"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"2.0074em",verticalAlign:"-0.686em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,t.jsx)(s.span,{className:"mfrac",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,t.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"mord",children:(0,t.jsx)(s.span,{className:"mord",children:"12.000.000"})})]}),(0,t.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,t.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,t.jsx)(s.span,{className:"mord",children:(0,t.jsx)(s.span,{className:"mord",children:"1"})})]})]}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,t.jsx)(s.span,{})})})]})}),(0,t.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"="}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.8389em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(s.span,{className:"mord",children:"20.83"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"\u03bc"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"})]})]})]})}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsx)(s.p,{children:"This approach is inefficient compared to the method used in Embassy."})}),"\n",(0,t.jsx)(s.h2,{id:"bare-metal",children:"Bare metal"}),"\n",(0,t.jsxs)(s.p,{children:["When using bare metal, developers interact directly with the hardware devices. They are responsible for all the\ndrivers and other components that they want to use. Mostly, bare metal development means ",(0,t.jsx)(s.em,{children:"reading"})," and ",(0,t.jsx)(s.em,{children:"writing"})," data\nfrom and to the MCUs and peripheral registers."]}),"\n",(0,t.jsx)(s.h3,{id:"configuring-the-sio-1",children:"Configuring the SIO"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.em,{children:"SIO"})," peripheral has a base address, the address where its registers are mapped in the address space."]}),"\n",(0,t.jsxs)(s.p,{children:["Each register has an offset, that represents the registers position (offset) relative to the ",(0,t.jsx)(s.em,{children:"SIO"}),"'s base address."]}),"\n",(0,t.jsxs)(s.admonition,{type:"tip",children:[(0,t.jsx)(s.p,{children:"Computing the actual address of a register means adding the base address of the peripheral with the register's offset."}),(0,t.jsxs)(s.p,{children:["e.g: ",(0,t.jsx)(s.code,{children:"GPIO_OE"}),"'s address is ",(0,t.jsx)(s.code,{children:"0xd000_0000 + 0x020"})," => ",(0,t.jsx)(s.code,{children:"0xd000_0020"})]})]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"SIO Registers",src:n(13612).c+"",width:"1564",height:"826"})})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"use core::ptr::write_volatile;\n\nconst GPIO_OE_SET: *mut u32 = 0xd000_0024 as *mut u32;\nconst GPIO_OUT_SET: *mut u32 = 0xd000_0014 as *mut u32;\nconst GPIO_OUT_CLR: *mut u32 = 0xd000_0018 as *mut u32;\n\n// set the `pin` pin as output\nunsafe { write_volatile(GPIO_OE_SET, 1 << pin); }\n\n// set the `pin` to value `0`\nunsafe { write_volatile(GPIO_OUT_CLR, 1 << pin); }\n\n// set the `pin` to value `1`\nunsafe { write_volatile(GPIO_OUT_SET, 1 << pin); }\n"})}),"\n",(0,t.jsxs)(s.admonition,{type:"info",children:[(0,t.jsx)(s.mdxAdmonitionTitle,{}),(0,t.jsxs)(s.p,{children:["For a better understanding, please read subchapters 2.3.1.2 and 2.3.1.7 of the ",(0,t.jsx)(s.a,{href:"https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf",children:"datasheet"}),"."]})]}),"\n",(0,t.jsx)(s.h4,{id:"enable-the-io-bank",children:"Enable the IO Bank"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"const RESET: u32 = 0x4000_c000;\nconst CLR: u32 = 0x3000;\n\nconst RESET_DONE: u32 = 0x4000_c008;\n\nunsafe {\n    // clear bit `5` of the `RESET` register by\n    // writing `1` on  bit `5` at address\n    // `RESET` + 0x3000\n    write_volatile((RESET + CLR) as *mut u32, 1 << 5);\n\n    // wait for the IO Bank0 to enable\n    while read_volatile(RESET_DONE as *const u32) & (1 << 5) == 0 {}\n}\n"})}),"\n",(0,t.jsxs)(s.admonition,{type:"tip",children:[(0,t.jsxs)(s.p,{children:["There is an interesting trick that the code above is using. Normally, the code modifies only the\nbit 5 of the ",(0,t.jsx)(s.code,{children:"RESET"})," register. To perform that, it should:"]}),(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"read the register"}),"\n",(0,t.jsx)(s.li,{children:"modify the value read"}),"\n",(0,t.jsx)(s.li,{children:"write back the modified value"}),"\n"]}),(0,t.jsxs)(s.p,{children:["The RP2040 MCU provides a trick that allows the instant modification. For each peripheral mapped at\naddress A, the MCU's Bus maps three other ",(0,t.jsx)(s.em,{children:"shadow"})," peripherals:"]}),(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Name"}),(0,t.jsx)(s.th,{children:"Address"}),(0,t.jsx)(s.th,{children:"Behavior"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.em,{children:"Peripheral_XOR"})}),(0,t.jsx)(s.td,{children:"A+0x1000"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"REGISTER"})," = ",(0,t.jsx)(s.code,{children:"REGISTER"})," ^ value (XORs the new value with the original register value)"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.em,{children:"Peripheral_SET"})}),(0,t.jsx)(s.td,{children:"A+0x2000"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"REGISTER"})," = ",(0,t.jsx)(s.code,{children:"REGISTER"})," | value (sets all the ",(0,t.jsx)(s.code,{children:"1"})," bits of value in the original register)"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.em,{children:"Peripheral_CLR"})}),(0,t.jsx)(s.td,{children:"A+0x3000"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"REGISTER"})," = ",(0,t.jsx)(s.code,{children:"REGISTER"})," & !value (for every ",(0,t.jsx)(s.code,{children:"1"})," bit in the value, clears the corresponding bit in the original register)"]})]})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"configure-the-gpio-1",children:"Configure the GPIO"}),"\n",(0,t.jsxs)(s.p,{children:["To connect the ",(0,t.jsx)(s.em,{children:"SIO"})," peripheral to the output pins, developers have to modify the ",(0,t.jsx)(s.code,{children:"GPIOx_CTRL"})," register."]}),"\n",(0,t.jsxs)(s.p,{children:["Each GPIO pin has its own control register, located at offset ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mn,{children:"40014000"}),(0,t.jsx)(s.mi,{children:"h"}),(0,t.jsx)(s.mo,{children:"+"}),(0,t.jsx)(s.mn,{children:"4"}),(0,t.jsx)(s.mo,{children:"+"}),(0,t.jsx)(s.mn,{children:"8"}),(0,t.jsx)(s.mo,{children:"\u2217"}),(0,t.jsx)(s.mi,{children:"p"}),(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mi,{children:"n"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"40014000h + 4 + 8 * pin"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,t.jsx)(s.span,{className:"mord",children:"40014000"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"h"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(s.span,{className:"mbin",children:"+"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.jsx)(s.span,{className:"mord",children:"4"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(s.span,{className:"mbin",children:"+"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,t.jsx)(s.span,{className:"mord",children:"8"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(s.span,{className:"mbin",children:"\u2217"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.854em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"in"})]})]})]}),"."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"MCU Pins",src:n(74796).c+"",width:"1454",height:"260"})})}),"\n",(0,t.jsxs)(s.admonition,{type:"tip",children:[(0,t.jsxs)(s.p,{children:["For example, ",(0,t.jsx)(s.code,{children:"GPIO25_CTRL"}),"'s address is ",(0,t.jsx)(s.code,{children:"0x40014000 + 4 + 8 * 25"})," = ",(0,t.jsx)(s.code,{children:"0x400140CC"}),".\n."]}),(0,t.jsx)(s.p,{children:"Pin 25 is connected to the onboard LED of the Raspberry Pi Pico."})]}),"\n",(0,t.jsxs)(s.p,{children:["The following table shows the fields of the ",(0,t.jsx)(s.code,{children:"GPIOx_CTRL"})," register. The fields that is of interest is ",(0,t.jsx)(s.code,{children:"FUNCSEL"}),".\nDepending on the value written there, the ",(0,t.jsx)(s.em,{children:"IO Bank0"})," will select a function or another. For this example,\nwe have to write value ",(0,t.jsx)(s.code,{children:"5"}),"."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"MCU Pins",src:n(85400).c+"",width:"1444",height:"1416"})})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:"const GPIOX_CTRL: u32 = 0x4001_4004;\n\n// compute the address of the GPIOx_CTRL register\nlet gpio_ctrl = (GPIOX_CTRL + 8 * LED) as *mut u32;\n\n// write the value 5 to the FUNCSEL field\n// Note: This actually writes the value 5 in FUNCSEL\n//       and 0s in all the other field. While this\n//       is fine for this example, usually a\n//       read, modify, write sequence should be used\nunsafe { write_volatile(gpio_ctrl, 5); }\n"})}),"\n",(0,t.jsxs)(s.admonition,{type:"info",children:[(0,t.jsx)(s.mdxAdmonitionTitle,{}),(0,t.jsxs)(s.p,{children:["For a better understanding, please read subchapters 1.4.3, 2.1.12, 2.14, 2.19.1, 2.19.2, 2.19.15, 2.19.16 of the ",(0,t.jsx)(s.a,{href:"https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf",children:"datasheet"}),"."]})]}),"\n",(0,t.jsx)(s.h2,{id:"build-and-flash",children:"Build and flash"}),"\n",(0,t.jsx)(s.h3,{id:"build",children:"Build"}),"\n",(0,t.jsxs)(s.p,{children:["To build a program for the Raspberry Pi Pico, run the following command in the crate's root folder (where the ",(0,t.jsx)(s.code,{children:"Cargo.toml"})," file and ",(0,t.jsx)(s.code,{children:"src"})," folder are):"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"cargo build\n"})}),"\n",(0,t.jsxs)(s.p,{children:["This will create the binary file inside ",(0,t.jsx)(s.code,{children:"target/thumbv6m-none-eabi/debug/"}),"."]}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["If the crate is part of a workspace (as it is the lab template), the ",(0,t.jsx)(s.code,{children:"target"})," folder is located in the workspace's root instead of the crate's root."]})}),"\n",(0,t.jsx)(s.h3,{id:"flash",children:"Flash"}),"\n",(0,t.jsxs)(s.p,{children:["To load your program to the Raspberry Pi Pico, connect the board through USB to your computer while holding down the ",(0,t.jsx)(s.code,{children:"BOOTSEL"})," button. It should appear as an external drive on your system. Afterwards, you can run the following command (also from the crate's root folder):"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"elf2uf2-rs -d target/thumbv6m-none-eabi/debug/<crate_name>\n"})}),"\n",(0,t.jsx)(s.p,{children:"This will upload your program to the Pico."}),"\n",(0,t.jsxs)(s.admonition,{type:"note",children:[(0,t.jsxs)(s.p,{children:["If you are running this command from within a crate inside of a workspace, don't forget to navigate to the target folder by using ",(0,t.jsx)(s.code,{children:"../../"}),"\nExample:"]}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"elf2uf2-rs -d ../../target/thumbv6m-none-eabi/debug/<crate_name>\n"})})]}),"\n",(0,t.jsxs)(s.admonition,{type:"note",children:[(0,t.jsx)(s.p,{children:"If the above command doesn't work, try these steps instead:"}),(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"run this command:"}),"\n"]}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"elf2uf2-rs target/thumbv6m-none-eabi/debug/<crate_name>\n"})}),(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["drag and drop the ",(0,t.jsx)(s.code,{children:".uf2"})," file located in the ",(0,t.jsx)(s.code,{children:"target/thumbv6m-none-eabi/debug/"})," folder to the RP external drive"]}),"\n"]})]}),"\n",(0,t.jsx)(s.h3,{id:"serial-console",children:"Serial console"}),"\n",(0,t.jsxs)(s.p,{children:["To see messages from the Pico over the serial port, add the ",(0,t.jsx)(s.code,{children:"-s"})," argument to the flash command:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"elf2uf2-rs -s -d /target/thumbv6m-none-eabi/debug/<crate_name>\n"})}),"\n",(0,t.jsx)(s.p,{children:"This will allow us to see messages sent over serial from the board."}),"\n",(0,t.jsx)(s.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(s.h4,{id:"link-error---reset-vector-is-missing",children:"Link error - reset vector is missing"}),"\n",(0,t.jsx)(s.p,{children:"In case you get an error similar to this:"}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Reset Vectors Missing",src:n(9524).c+"",width:"838",height:"314"})})}),"\n",(0,t.jsxs)(s.p,{children:["That means that you most probably forgot to add the ",(0,t.jsx)(s.em,{children:"entry point"})," to your program. Make sure you add ",(0,t.jsx)(s.code,{children:"#[entry]"})," before your main function so that the MCU knows to call it at startup."]}),"\n",(0,t.jsx)(s.h4,{id:"flash-succeeds-the-application-does-not-start",children:"Flash succeeds, the application does not start"}),"\n",(0,t.jsxs)(s.p,{children:["In case your code doesn't seem to get uploaded correctly or the board goes into ",(0,t.jsx)(s.code,{children:"BOOTSEL"})," mode as soon as you plug it into your computer, it might be time to debug. To install required dependencies for debugging, run these commands:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"rustup component add llvm-tools\n\ncargo install cargo-binutils\n"})}),"\n",(0,t.jsx)(s.p,{children:"Now, you can run this command:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"rust-objdump --section-headers target/thumbv6m-none-eabi/debug/<crate_name>\n"})}),"\n",(0,t.jsx)(s.p,{children:"This will let us see the layout of the binary file, or the memory of the program that we are about to flash to the board."}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Rust ObjDump",src:n(50004).c+"",width:"426",height:"580"})})}),"\n",(0,t.jsxs)(s.p,{children:["We need to make sure that it contains the ",(0,t.jsx)(s.code,{children:".boot_loader"})," section, or else our program will never run."]}),"\n",(0,t.jsxs)(s.p,{children:["Further reading: ",(0,t.jsx)(s.a,{href:"../tutorials/embassy",children:"Embassy Tutorial"})]}),"\n",(0,t.jsx)(s.h2,{id:"exercises",children:"Exercises"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Use ",(0,t.jsx)(s.a,{href:"https://www.kicad.org/",children:"KiCad"})," to design a simple circuit that connects an LED to GPIO 0 (GP0). (",(0,t.jsx)(s.strong,{children:"1p"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(s.admonition,{type:"warning",children:[(0,t.jsx)(s.mdxAdmonitionTitle,{}),(0,t.jsxs)(s.p,{children:["The maximum current that GPIO pins output depends on the MCU. To be sure that the LED will work normally and there is no risk of destruction, a resistor has to be added to limit the current level ",(0,t.jsx)(s.em,{children:"below"})," the maximum GPIO output current."]})]}),"\n",(0,t.jsxs)(s.ol,{start:"2",children:["\n",(0,t.jsxs)(s.li,{children:["Write a program using Embassy that set on HIGH the LED connected to GPIO pin 0 (GP0). (",(0,t.jsx)(s.strong,{children:"2p"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(s.admonition,{type:"danger",children:[(0,t.jsx)(s.mdxAdmonitionTitle,{}),(0,t.jsx)(s.p,{children:"Please make sure the lab professor verifies your circuit before it is powered up."})]}),"\n",(0,t.jsxs)(s.ol,{start:"3",children:["\n",(0,t.jsxs)(s.li,{children:["Write a program using Embassy that blinks the LED connected to GPIO pin 0 (GP0) every 300ms. (",(0,t.jsx)(s.strong,{children:"2p"}),")"]}),"\n"]}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsxs)(s.p,{children:["For the purpose of this lab, please use ",(0,t.jsx)(s.code,{children:"await"})," as is, think that for using the ",(0,t.jsx)(s.code,{children:"Timer"}),", you have to add ",(0,t.jsx)(s.code,{children:".await"})," after the ",(0,t.jsx)(s.code,{children:"after"})," function."]})}),"\n",(0,t.jsxs)(s.ol,{start:"4",children:["\n",(0,t.jsxs)(s.li,{children:["Write a program using ",(0,t.jsx)(s.code,{children:"embassy-rs"}),' that will write the message "The button was pressed" to the console every time button A is pressed. Take a look at the Pico Explorer Base\'s pinout to determine the pin to which button A is connected. (',(0,t.jsx)(s.strong,{children:"2p"}),")"]}),"\n"]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Pico Explorer Pinout",src:n(42220).c+"",width:"800",height:"600"})})}),"\n",(0,t.jsxs)(s.admonition,{type:"info",children:[(0,t.jsx)(s.p,{children:"The Raspberry Pi Pico does not have an integrated debugger, so writing messages to the console is done\nwith a simulated serial port over the USB. This implies the usage of a USB driver."}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-rust",children:'use embassy_rp::usb::{Driver, InterruptHandler};\nuse embassy_rp::{bind_interrupts, peripherals::USB};\nuse log::info;\n\n// Use for the serial over USB driver\nbind_interrupts!(struct Irqs {\n    USBCTRL_IRQ => InterruptHandler<USB>;\n});\n\n\n// The task used by the serial port driver \n// over USB\n#[embassy_executor::task]\nasync fn logger_task(driver: Driver<\'static, USB>) {\n    embassy_usb_logger::run!(1024, log::LevelFilter::Info, driver);\n}\n\n#[embassy_executor::main]\nasync fn main(spawner: Spawner) {\n    let peripherals = embassy_rp::init(Default::default());\n\n    // Start the serial port over USB driver\n    let driver = Driver::new(peripherals.USB, Irqs);\n    spawner.spawn(logger_task(driver)).unwrap();\n\n    // ...\n\n    info!("message");\n}\n'})}),(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsx)(s.p,{children:"Make sure you sleep while looping to read the button's value, otherwise\nthe USB driver's task will not be able to run and the messages will\nnot be printed."})})]}),"\n",(0,t.jsx)(s.p,{children:":::"}),"\n",(0,t.jsxs)(s.ol,{start:"5",children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Write a Rust program using ",(0,t.jsx)(s.code,{children:"embassy-rs"})," that toggles the LED every time button A is pressed. (",(0,t.jsx)(s.strong,{children:"1p"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Write a Rust program that sets on HIGH the LED connected to GPIO pin 0 (GP0). (",(0,t.jsx)(s.strong,{children:"1p"}),")"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["use the ",(0,t.jsx)(s.code,{children:"rp2040-pac"})," crate"]}),"\n",(0,t.jsx)(s.li,{children:"use bare metal"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Write a Rust program that blinks the LED connected to GPIO pin 0 (GP0) every 300ms. (",(0,t.jsx)(s.strong,{children:"1p"}),")"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["use the ",(0,t.jsx)(s.code,{children:"rp2040-pac"})," crate - write a ",(0,t.jsx)(s.code,{children:"PinDriver"})," that implements the ",(0,t.jsx)(s.a,{href:"https://docs.rs/embedded-hal/latest/embedded_hal/digital/trait.OutputPin.html",children:(0,t.jsx)(s.code,{children:"OutputPin"})})," trait"]}),"\n",(0,t.jsxs)(s.li,{children:["use bare metal - write a ",(0,t.jsx)(s.code,{children:"PinDriver"})," that implements the ",(0,t.jsx)(s.a,{href:"https://docs.rs/embedded-hal/latest/embedded_hal/digital/trait.OutputPin.html",children:(0,t.jsx)(s.code,{children:"OutputPin"})})," trait"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"advanced-topics",children:"Advanced topics"}),"\n",(0,t.jsx)(s.h3,{id:"debouncing-techniques-for-stable-input-reading",children:"Debouncing techniques for stable input reading."}),"\n",(0,t.jsx)(s.p,{children:"Noise is produced whenever a pushbutton or other switch is moved. Because the switch contact is made of metal and has some elasticity, there is some noise (contact). The switch literally bounces a few times once it makes contact with a metal surface when it is shifted into a new position. This contact is known as bounce."}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Button Bounce",src:n(39392).c+"",width:"512",height:"289"})})}),"\n",(0,t.jsx)(s.p,{children:"The image above shows the signal produced by a button when pressed."}),"\n",(0,t.jsx)(s.p,{children:"The most correct way to correct the bouncing problem is the hardware one, but there are also software methods to correct the problem. For more details and examples, consult the documentation from Embassy-rs and the examples provided by them."})]})}function o(e={}){const{wrapper:s}={...(0,i.M)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},39392:(e,s,n)=>{n.d(s,{c:()=>t});const t="data:image/png;base64,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"},85400:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/gpio_ctrl_register-dc778eb8c02ba2d8e9ceba131d15843e.png"},89836:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/gpio_mux-e4a348a45def684b56fdace777269f64.png"},62888:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/gpio_pad_ctrl_1-d671eb0f38cbea49a9ce8bc89b76808e.png"},48180:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/gpio_pad_ctrl_2-070ccc0536928281ee835e788cb53b9a.png"},49944:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/gpio_pad_registers-761ef6756b29b932f095910b03420f1e.png"},74796:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/gpio_status_ctrl-6d9136c80e94b3841c05966e6e30226d.png"},50004:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/objdump-be6caf3ea7f7b3a29edada3e1dad98fc.png"},2388:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/pico-pinout-dd1099dbad1bed40f855431699089dc6.svg"},45840:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/pin_functions-fdb06f671cc97ac5762556279e0a7243.png"},44912:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/reset_registers-cf036134f671b7b67239f1c2042add6c.png"},61436:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/reset_reset-292eff7f7c95005256b91abeb913aff0.png"},65772:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/reset_reset_done-782724e7a569b4fc7cc8356a67983369.png"},9524:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/reset_vector_missing_error-75c9e1d7dbe2083d37adbf893b0a5efb.png"},14508:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/rust_embedded_stack-8b3f636797a4c516d4202359f33d0143.svg"},13612:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/sio_registers-55b3871fa9802e3f73ad39aa825e6be0.png"},42220:(e,s,n)=>{n.d(s,{c:()=>t});const t=n.p+"assets/images/explorer_pins-826d67f02154207c1b67514ed209149a.jpg"},4552:(e,s,n)=>{n.d(s,{I:()=>l,M:()=>a});var t=n(11504);const i={},r=t.createContext(i);function a(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);