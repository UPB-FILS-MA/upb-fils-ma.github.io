"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1192],{47474:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"project/2024/andrei.dragota/index","title":"GamePad Xinput API","description":"A game controller coded in Rust using Xinput API","source":"@site/versioned_docs/version-fils_en/project/2024/andrei.dragota/index.md","sourceDirName":"project/2024/andrei.dragota","slug":"/project/2024/andrei.dragota/","permalink":"/docs/fils_en/project/2024/andrei.dragota/","draft":false,"unlisted":false,"editUrl":"https://github.com/UPB-PMRust/upb-pmrust.github.io/edit/main/website/versioned_docs/version-fils_en/project/2024/andrei.dragota/index.md","tags":[],"version":"fils_en","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Project Name","permalink":"/docs/fils_en/project/2024/andrei.andreescu/index.md"},"next":{"title":"Chicken Invaders","permalink":"/docs/fils_en/project/2024/antonio.pelmus/"}}');var r=n(74848),s=n(28453);const o={},a="GamePad Xinput API",l={},c=[{value:"Description",id:"description",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Purpose",id:"purpose",level:3},{value:"Conclusions",id:"conclusions",level:3},{value:"Motivation",id:"motivation",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Main Components",id:"main-components",level:3},{value:"Connections",id:"connections",level:3},{value:"Log",id:"log",level:2},{value:"Week 6 - 12 May",id:"week-6---12-may",level:3},{value:"Week 7 - 19 May",id:"week-7---19-may",level:3},{value:"Week 20 - 26 May",id:"week-20---26-may",level:3},{value:"Hardware",id:"hardware",level:2},{value:"Schematics",id:"schematics",level:3},{value:"Bill of Materials",id:"bill-of-materials",level:3},{value:"Software",id:"software",level:2},{value:"Links",id:"links",level:2}];function d(e){const t={a:"a",admonition:"admonition",br:"br",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"gamepad-xinput-api",children:"GamePad Xinput API"})}),"\n",(0,r.jsx)(t.p,{children:"A game controller coded in Rust using Xinput API"}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Author"}),": Dragot\u0103 Andrei ",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.strong,{children:"GitHub Project Link"}),": ",(0,r.jsx)(t.a,{href:"https://github.com/UPB-FILS-MA/project-domnudragota",children:"https://github.com/UPB-FILS-MA/project-domnudragota"})]})}),"\n",(0,r.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,r.jsx)(t.h3,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(t.p,{children:"A rudimentary GamePad constructed on a breadboard serves as a functional prototype to test within various gaming environments. This DIY controller operates on the Windows XInput API, allowing the system to recognize it as an Xbox controller, thereby facilitating seamless integration with a wide range of games that support Xbox controller inputs. The underlying electronics and wiring are carefully assembled on a breadboard, providing a flexible platform for development and testing."}),"\n",(0,r.jsx)(t.h3,{id:"purpose",children:"Purpose"}),"\n",(0,r.jsx)(t.p,{children:"The primary goal of this project is to assess input latency across different gaming scenarios. By using this GamePad, which mimics the functionality of a standard Xbox controller, researchers can measure the time delay between user input and corresponding in-game actions. The experiment aims to gather data on input latency across a variety of platforms, including different operating systems, computer configurations, and monitor types. This information can help identify factors that contribute to input lag and inform hardware and software optimization strategies to improve gaming responsiveness.\nTesting environment"}),"\n",(0,r.jsx)(t.p,{children:"In addition to the breadboard GamePad, an official Xbox Series controller (plus PlayStation because why not) is included for comparative analysis. By conducting parallel tests with the DIY controller and the Xbox Series controller, researchers can evaluate how closely the breadboard-built GamePad matches the performance and responsiveness of a commercially available controller. This comparative approach provides a baseline to assess whether the homemade controller exhibits any additional latency or other unexpected behavior."}),"\n",(0,r.jsx)(t.h3,{id:"conclusions",children:"Conclusions"}),"\n",(0,r.jsx)(t.p,{children:"Basically, this project has both a technical and practical focus: it explores the construction and functionality of a custom-built controller, while simultaneously addressing broader questions related to gaming performance, user experience, and system optimization. The findings from this study could have implications for gamers, developers, and hardware manufacturers interested in minimizing input latency and enhancing gameplay fluidity."}),"\n",(0,r.jsx)(t.h2,{id:"motivation",children:"Motivation"}),"\n",(0,r.jsx)(t.p,{children:"As it can be probably guessed from the above paragraphs, I want to combine 2 subjects which are on opposite measurement axis (creativity and art with engineering projects). I believe that this project will help me understand how much time and effort developpers and engineers put when designing even just a little piece of the hardware part for the console or computer. Moreover, I'm keen on challenges and I wish to learn Rust as a new and innovative programming language, in comparison, I come from Java langaguage so Rust might be the perfect mix for me for C/C++ and Java. Furthermore (and last idea I promise) I want to create a small presentation involving statistics and measuring data to show that projects can be done in an equal rhythm with fun, creativity and hard work."}),"\n",(0,r.jsx)(t.h2,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"architecture",src:n(55642).A+"",width:"750",height:"790"})}),"\n",(0,r.jsx)(t.p,{children:"Here is a small diagram of all the connections (I think) should be neccessary for the controller. I'll also try to describe it in words. Hopefully it will make sense."}),"\n",(0,r.jsx)(t.h3,{id:"main-components",children:"Main Components"}),"\n",(0,r.jsx)(t.p,{children:"Controller Interface->\nThis is the collection of user input elements, including buttons, joysticks, and directional pads. It's what the user interacts with to control the game."}),"\n",(0,r.jsx)(t.p,{children:"Signal Processing->\nThis component receives input signals from the controller interface and translates them into data that the microcontroller can process. In this case, it includes the voltage dividers for button groupings."}),"\n",(0,r.jsx)(t.p,{children:"Microcontroller->\nThe central component responsible for processing input data, managing the XInput API communication, and handling USB communication. The Raspberry Pi Pico W is used for this project."}),"\n",(0,r.jsx)(t.p,{children:"USB Interface->\nThis is the connection point between the microcontroller and the host system (e.g., a Windows computer). It allows the controller to be recognized as an XInput device."}),"\n",(0,r.jsx)(t.p,{children:"XInput Communication->\nThis component encapsulates the interaction between the microcontroller and the host system through the XInput API. It translates input signals into a format that games can understand."}),"\n",(0,r.jsx)(t.h3,{id:"connections",children:"Connections"}),"\n",(0,r.jsx)(t.p,{children:"Controller Interface to Signal Processing->\nThe input components (buttons, joysticks, etc.) are connected to the signal processing unit. Voltage dividers are used to group certain buttons, reducing the number of required digital pins."}),"\n",(0,r.jsx)(t.p,{children:"Signal Processing to Microcontroller->\nThe processed signals are sent to the microcontroller for further handling. The microcontroller is responsible for interpreting the inputs and sending appropriate responses to the host system."}),"\n",(0,r.jsx)(t.p,{children:"Microcontroller to USB Interface->\nThe microcontroller connects to the USB interface, which allows it to communicate with the host system. This connection enables the controller to be recognized as an XInput device."}),"\n",(0,r.jsx)(t.p,{children:"Microcontroller to XInput Communication ->\nThe microcontroller sends input data to the host system using the XInput API. This component ensures that the controller's input is properly formatted and recognized by compatible games."}),"\n",(0,r.jsx)(t.h2,{id:"log",children:"Log"}),"\n",(0,r.jsx)(t.h3,{id:"week-6---12-may",children:"Week 6 - 12 May"}),"\n",(0,r.jsx)(t.p,{children:"Designed the hardware on the breadboard, applied the voltage dividers to the circuit, finished up the KiCad hardware schematic"}),"\n",(0,r.jsx)(t.h3,{id:"week-7---19-may",children:"Week 7 - 19 May"}),"\n",(0,r.jsx)(t.p,{children:"Finished up the hardware on the breadboard + final version on KiCad. Should start with software now."}),"\n",(0,r.jsx)(t.h3,{id:"week-20---26-may",children:"Week 20 - 26 May"}),"\n",(0,r.jsx)(t.p,{children:"Software is finished. Windows detects the Pico W as a generic xbox 360 controller and responds to inputs. Code is in project repo."}),"\n",(0,r.jsx)(t.h2,{id:"hardware",children:"Hardware"}),"\n",(0,r.jsx)(t.p,{children:"The controller has 16 buttons, 2 vibration motors, 2 joysticks, resistances of 220 ohms to not blow up the circuit. Pico will process all the inputs from the buttons and will translate it for the XInput app."}),"\n",(0,r.jsx)(t.p,{children:"To implement the project, you need a board with a native USB port, such as the Raspberry Pi Pico."}),"\n",(0,r.jsx)(t.p,{children:"I chose to use two voltage dividers to save the digital pins on the board. The directional buttons and the A/B/X/Y buttons are grouped by 4 in a voltage divider."}),"\n",(0,r.jsx)(t.p,{children:"The disadvantage of these groupings is that two or more buttons from the same group cannot be read simultaneously. For example, pressing buttons A and B at the same time will send to the analog pin the value corresponding to pressing button B, not both. (fixed it, should work)"}),"\n",(0,r.jsx)(t.p,{children:'Another compromise is the fact that, for reasons of availability, the "Trigger" buttons are not analog. The value sent to the XInput API is either 0% pressed or 100% pressed.'}),"\n",(0,r.jsx)(t.h3,{id:"schematics",children:"Schematics"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"hardware",src:n(58227).A+"",width:"3507",height:"2480"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"hardware_implementation",src:n(95858).A+"",width:"1512",height:"2016"})}),"\n",(0,r.jsx)(t.h3,{id:"bill-of-materials",children:"Bill of Materials"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Device"}),(0,r.jsx)(t.th,{children:"Usage"}),(0,r.jsx)(t.th,{children:"Price"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://www.raspberrypi.com/documentation/microcontrollers/raspberry-pi-pico.html",children:"Rapspberry Pi Pico W"})}),(0,r.jsx)(t.td,{children:"The microcontroller"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://www.optimusdigital.ro/en/raspberry-pi-boards/12394-raspberry-pi-pico-w.html",children:"35 RON"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2 x BreadBoard"}),(0,r.jsx)(t.td,{children:"Build the circuit"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://www.optimusdigital.ro/ro/prototipare-breadboard-uri/8-breadboard-830-points.html",children:"20 RON"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Buttons ( 12-15 )"}),(0,r.jsx)(t.td,{children:"Input for controller"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://www.optimusdigital.ro/ro/butoane-i-comutatoare/1119-buton-6x6x6.html?search_query=buton&results=222",children:"5 RON"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Resistances"}),(0,r.jsx)(t.td,{children:"To not fry the circuit"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://www.optimusdigital.ro/ro/componente-electronice-rezistoare/858-rezistor-025w-18k.html?search_query=rezistor&results=120",children:"5 RON"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2x JoySticks"}),(0,r.jsx)(t.td,{children:"Move and aim with the controller"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://www.optimusdigital.ro/ro/senzori-senzori-de-atingere/742-modul-joystick-ps2-biaxial-negru-cu-5-pini.html?search_query=joystick&results=42",children:"10 RON"})})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"software",children:"Software"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Library"}),(0,r.jsx)(t.th,{children:"Description"}),(0,r.jsx)(t.th,{children:"Usage"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://docs.rs/rusty-xinput/latest/rusty_xinput/#",children:"rusty_xinput"})}),(0,r.jsx)(t.td,{children:"Crate for Rust"}),(0,r.jsx)(t.td,{children:"Implements Xinput .dll in Rust, has several functions"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://docs.rs/gilrs/latest/gilrs/",children:"gilrs"})}),(0,r.jsx)(t.td,{children:"GilRs - Game Input Library for Rust"}),(0,r.jsx)(t.td,{children:"GilRs abstract platform specific APIs to provide unified interfaces for working with gamepads"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows/win32/xinput/xinput-game-controller-apis-portal",children:"Xinput"})}),(0,r.jsx)(t.td,{children:"Bread and butter of this project (main driver)"}),(0,r.jsx)(t.td,{children:"Xinput, comes with Windows"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://github.com/embassy-rs/embassy",children:"embassy_rs"})}),(0,r.jsx)(t.td,{children:"Embassy framework for embedded systems"}),(0,r.jsx)(t.td,{children:"Implement specifically USB module, ADC converter, UDP Wi-fi"})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"links",children:"Links"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows/win32/xinput/getting-started-with-xinput",children:"Microsoft Official Doc"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://dev.to/jeikabu/gamepad-input-with-rust-2oji",children:"Implementation example"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://www.youtube.com/watch?v=YEDTK_Yv0vo",children:"Sketch of a controller using spare parts"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},55642:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/architecture-43974567173be88a53f3f9de40af9685.png"},58227:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/hardware-41190e593fbbdbeef97d9e6202077347.png"},95858:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/hardware_implementation-7ea7e32e68145c83cca75d39f0dfe7e5.jpg"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);